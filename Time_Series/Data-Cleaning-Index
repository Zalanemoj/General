{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "66e370cf",
   "metadata": {
    "papermill": {
     "duration": 0.005785,
     "end_time": "2026-01-25T09:09:11.729386",
     "exception": false,
     "start_time": "2026-01-25T09:09:11.723601",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Libraries"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "46ef8948",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:11.741318Z",
     "iopub.status.busy": "2026-01-25T09:09:11.740318Z",
     "iopub.status.idle": "2026-01-25T09:09:13.416606Z",
     "shell.execute_reply": "2026-01-25T09:09:13.415387Z"
    },
    "papermill": {
     "duration": 1.684368,
     "end_time": "2026-01-25T09:09:13.418780",
     "exception": false,
     "start_time": "2026-01-25T09:09:11.734412",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import tqdm.auto as tqdm\n",
    "import os\n",
    "import warnings\n",
    "warnings.filterwarnings('ignore')\n",
    "from functools import reduce"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "6a05448f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:13.430522Z",
     "iopub.status.busy": "2026-01-25T09:09:13.429948Z",
     "iopub.status.idle": "2026-01-25T09:09:13.481816Z",
     "shell.execute_reply": "2026-01-25T09:09:13.479970Z"
    },
    "papermill": {
     "duration": 0.060841,
     "end_time": "2026-01-25T09:09:13.484403",
     "exception": false,
     "start_time": "2026-01-25T09:09:13.423562",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df_hdfc=pd.read_csv('/kaggle/input/data-cleaning-historical/Cleaned_RELIANCE.NS_Max.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "84937e12",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:13.498739Z",
     "iopub.status.busy": "2026-01-25T09:09:13.497623Z",
     "iopub.status.idle": "2026-01-25T09:09:13.530738Z",
     "shell.execute_reply": "2026-01-25T09:09:13.529279Z"
    },
    "papermill": {
     "duration": 0.043614,
     "end_time": "2026-01-25T09:09:13.533110",
     "exception": false,
     "start_time": "2026-01-25T09:09:13.489496",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Date</th>\n",
       "      <th>Open</th>\n",
       "      <th>High</th>\n",
       "      <th>Low</th>\n",
       "      <th>Close</th>\n",
       "      <th>Adj Close</th>\n",
       "      <th>Volume</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1995-12-31</td>\n",
       "      <td>7.319124</td>\n",
       "      <td>7.358397</td>\n",
       "      <td>7.270925</td>\n",
       "      <td>7.345901</td>\n",
       "      <td>4.617048</td>\n",
       "      <td>104121369</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1996-01-01</td>\n",
       "      <td>7.328050</td>\n",
       "      <td>7.363753</td>\n",
       "      <td>7.235222</td>\n",
       "      <td>7.288776</td>\n",
       "      <td>4.581145</td>\n",
       "      <td>168743308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1996-01-02</td>\n",
       "      <td>7.408381</td>\n",
       "      <td>7.745775</td>\n",
       "      <td>7.328050</td>\n",
       "      <td>7.344116</td>\n",
       "      <td>4.615928</td>\n",
       "      <td>209323879</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1996-01-03</td>\n",
       "      <td>7.274495</td>\n",
       "      <td>7.297702</td>\n",
       "      <td>7.178097</td>\n",
       "      <td>7.276280</td>\n",
       "      <td>4.573291</td>\n",
       "      <td>216900264</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1996-01-04</td>\n",
       "      <td>7.247718</td>\n",
       "      <td>7.247718</td>\n",
       "      <td>7.163816</td>\n",
       "      <td>7.226296</td>\n",
       "      <td>4.541874</td>\n",
       "      <td>166708467</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         Date      Open      High       Low     Close  Adj Close     Volume\n",
       "0  1995-12-31  7.319124  7.358397  7.270925  7.345901   4.617048  104121369\n",
       "1  1996-01-01  7.328050  7.363753  7.235222  7.288776   4.581145  168743308\n",
       "2  1996-01-02  7.408381  7.745775  7.328050  7.344116   4.615928  209323879\n",
       "3  1996-01-03  7.274495  7.297702  7.178097  7.276280   4.573291  216900264\n",
       "4  1996-01-04  7.247718  7.247718  7.163816  7.226296   4.541874  166708467"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_hdfc.head(5)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "16254e8c",
   "metadata": {
    "papermill": {
     "duration": 0.004632,
     "end_time": "2026-01-25T09:09:13.542430",
     "exception": false,
     "start_time": "2026-01-25T09:09:13.537798",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Preprocessing/Adding prefic to coloumns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "b7e347e7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:13.554640Z",
     "iopub.status.busy": "2026-01-25T09:09:13.554263Z",
     "iopub.status.idle": "2026-01-25T09:09:13.562442Z",
     "shell.execute_reply": "2026-01-25T09:09:13.561339Z"
    },
    "papermill": {
     "duration": 0.017047,
     "end_time": "2026-01-25T09:09:13.564698",
     "exception": false,
     "start_time": "2026-01-25T09:09:13.547651",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df_hdfc = df_hdfc.add_prefix('HDFC_')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "f2b2be30",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:13.577390Z",
     "iopub.status.busy": "2026-01-25T09:09:13.576820Z",
     "iopub.status.idle": "2026-01-25T09:09:13.582612Z",
     "shell.execute_reply": "2026-01-25T09:09:13.581363Z"
    },
    "papermill": {
     "duration": 0.014945,
     "end_time": "2026-01-25T09:09:13.584810",
     "exception": false,
     "start_time": "2026-01-25T09:09:13.569865",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "def add_prefix_function(data,prefix):\n",
    "    return data.add_prefix(prefix)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "0b03ce20",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:13.596524Z",
     "iopub.status.busy": "2026-01-25T09:09:13.596068Z",
     "iopub.status.idle": "2026-01-25T09:09:13.602195Z",
     "shell.execute_reply": "2026-01-25T09:09:13.601094Z"
    },
    "papermill": {
     "duration": 0.014078,
     "end_time": "2026-01-25T09:09:13.604087",
     "exception": false,
     "start_time": "2026-01-25T09:09:13.590009",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df_hdfc = add_prefix_function(df_hdfc, \"HDFC_\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "44ffdec7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:13.616261Z",
     "iopub.status.busy": "2026-01-25T09:09:13.615119Z",
     "iopub.status.idle": "2026-01-25T09:09:13.628779Z",
     "shell.execute_reply": "2026-01-25T09:09:13.627613Z"
    },
    "papermill": {
     "duration": 0.021913,
     "end_time": "2026-01-25T09:09:13.630778",
     "exception": false,
     "start_time": "2026-01-25T09:09:13.608865",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>HDFC_HDFC_Date</th>\n",
       "      <th>HDFC_HDFC_Open</th>\n",
       "      <th>HDFC_HDFC_High</th>\n",
       "      <th>HDFC_HDFC_Low</th>\n",
       "      <th>HDFC_HDFC_Close</th>\n",
       "      <th>HDFC_HDFC_Adj Close</th>\n",
       "      <th>HDFC_HDFC_Volume</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1995-12-31</td>\n",
       "      <td>7.319124</td>\n",
       "      <td>7.358397</td>\n",
       "      <td>7.270925</td>\n",
       "      <td>7.345901</td>\n",
       "      <td>4.617048</td>\n",
       "      <td>104121369</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1996-01-01</td>\n",
       "      <td>7.328050</td>\n",
       "      <td>7.363753</td>\n",
       "      <td>7.235222</td>\n",
       "      <td>7.288776</td>\n",
       "      <td>4.581145</td>\n",
       "      <td>168743308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1996-01-02</td>\n",
       "      <td>7.408381</td>\n",
       "      <td>7.745775</td>\n",
       "      <td>7.328050</td>\n",
       "      <td>7.344116</td>\n",
       "      <td>4.615928</td>\n",
       "      <td>209323879</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1996-01-03</td>\n",
       "      <td>7.274495</td>\n",
       "      <td>7.297702</td>\n",
       "      <td>7.178097</td>\n",
       "      <td>7.276280</td>\n",
       "      <td>4.573291</td>\n",
       "      <td>216900264</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1996-01-04</td>\n",
       "      <td>7.247718</td>\n",
       "      <td>7.247718</td>\n",
       "      <td>7.163816</td>\n",
       "      <td>7.226296</td>\n",
       "      <td>4.541874</td>\n",
       "      <td>166708467</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  HDFC_HDFC_Date  HDFC_HDFC_Open  HDFC_HDFC_High  HDFC_HDFC_Low  \\\n",
       "0     1995-12-31        7.319124        7.358397       7.270925   \n",
       "1     1996-01-01        7.328050        7.363753       7.235222   \n",
       "2     1996-01-02        7.408381        7.745775       7.328050   \n",
       "3     1996-01-03        7.274495        7.297702       7.178097   \n",
       "4     1996-01-04        7.247718        7.247718       7.163816   \n",
       "\n",
       "   HDFC_HDFC_Close  HDFC_HDFC_Adj Close  HDFC_HDFC_Volume  \n",
       "0         7.345901             4.617048         104121369  \n",
       "1         7.288776             4.581145         168743308  \n",
       "2         7.344116             4.615928         209323879  \n",
       "3         7.276280             4.573291         216900264  \n",
       "4         7.226296             4.541874         166708467  "
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_hdfc.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "3169269b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:13.644060Z",
     "iopub.status.busy": "2026-01-25T09:09:13.642839Z",
     "iopub.status.idle": "2026-01-25T09:09:13.652465Z",
     "shell.execute_reply": "2026-01-25T09:09:13.651435Z"
    },
    "papermill": {
     "duration": 0.0181,
     "end_time": "2026-01-25T09:09:13.654683",
     "exception": false,
     "start_time": "2026-01-25T09:09:13.636583",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import glob\n",
    "list_to_make_changes=glob.glob('/kaggle/input/data-cleaning-historical/*.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "d5e54fe1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:13.666344Z",
     "iopub.status.busy": "2026-01-25T09:09:13.665935Z",
     "iopub.status.idle": "2026-01-25T09:09:13.672034Z",
     "shell.execute_reply": "2026-01-25T09:09:13.670747Z"
    },
    "papermill": {
     "duration": 0.014619,
     "end_time": "2026-01-25T09:09:13.674256",
     "exception": false,
     "start_time": "2026-01-25T09:09:13.659637",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['/kaggle/input/data-cleaning-historical/Cleaned_NSEI_MAX.csv', '/kaggle/input/data-cleaning-historical/Cleaned_IXIC_Max.csv', '/kaggle/input/data-cleaning-historical/Cleaned_HDFCBANK.NS_MAX_NSE.csv', '/kaggle/input/data-cleaning-historical/Cleaned_GSPC_Max.csv', '/kaggle/input/data-cleaning-historical/Cleaned_BSESN_Max.csv', '/kaggle/input/data-cleaning-historical/Cleaned_RELIANCE.NS_Max.csv', '/kaggle/input/data-cleaning-historical/Cleaned_RUT_Max.csv']\n"
     ]
    }
   ],
   "source": [
    "print(list_to_make_changes)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "162f7c12",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:13.686493Z",
     "iopub.status.busy": "2026-01-25T09:09:13.685978Z",
     "iopub.status.idle": "2026-01-25T09:09:13.692417Z",
     "shell.execute_reply": "2026-01-25T09:09:13.690938Z"
    },
    "papermill": {
     "duration": 0.015641,
     "end_time": "2026-01-25T09:09:13.695118",
     "exception": false,
     "start_time": "2026-01-25T09:09:13.679477",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "prefix=[]\n",
    "for i in list_to_make_changes:\n",
    "    filename=os.path.basename(i)\n",
    "    prefix.append(filename.split('_')[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "bf4fdba6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:13.707418Z",
     "iopub.status.busy": "2026-01-25T09:09:13.706926Z",
     "iopub.status.idle": "2026-01-25T09:09:13.713573Z",
     "shell.execute_reply": "2026-01-25T09:09:13.712018Z"
    },
    "papermill": {
     "duration": 0.015399,
     "end_time": "2026-01-25T09:09:13.715990",
     "exception": false,
     "start_time": "2026-01-25T09:09:13.700591",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['NSEI', 'IXIC', 'HDFCBANK.NS', 'GSPC', 'BSESN', 'RELIANCE.NS', 'RUT']\n"
     ]
    }
   ],
   "source": [
    "print(prefix)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "1cc37069",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:13.728251Z",
     "iopub.status.busy": "2026-01-25T09:09:13.727434Z",
     "iopub.status.idle": "2026-01-25T09:09:13.733839Z",
     "shell.execute_reply": "2026-01-25T09:09:13.732665Z"
    },
    "papermill": {
     "duration": 0.014967,
     "end_time": "2026-01-25T09:09:13.736103",
     "exception": false,
     "start_time": "2026-01-25T09:09:13.721136",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "prefix.remove('RELIANCE.NS')\n",
    "list_to_make_changes.remove('/kaggle/input/data-cleaning-historical/Cleaned_RELIANCE.NS_Max.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "b292cbd0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:13.748513Z",
     "iopub.status.busy": "2026-01-25T09:09:13.747443Z",
     "iopub.status.idle": "2026-01-25T09:09:14.475321Z",
     "shell.execute_reply": "2026-01-25T09:09:14.474113Z"
    },
    "papermill": {
     "duration": 0.736555,
     "end_time": "2026-01-25T09:09:14.477686",
     "exception": false,
     "start_time": "2026-01-25T09:09:13.741131",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "all_data=[]\n",
    "for file_path,p in zip(list_to_make_changes,prefix):\n",
    "    data=pd.read_csv(file_path)\n",
    "    data.columns.str.upper()\n",
    "    if 'Date' in data.columns:\n",
    "        data['Date']=pd.to_datetime(data['Date'])\n",
    "        data=data.set_index('Date')\n",
    "    data=add_prefix_function(data,f\"{p}_\")\n",
    "    all_data.append(data)\n",
    "    data.to_csv(f'{p}.csv',index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "023e79ee",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:14.489104Z",
     "iopub.status.busy": "2026-01-25T09:09:14.488750Z",
     "iopub.status.idle": "2026-01-25T09:09:14.507017Z",
     "shell.execute_reply": "2026-01-25T09:09:14.505891Z"
    },
    "papermill": {
     "duration": 0.026788,
     "end_time": "2026-01-25T09:09:14.509417",
     "exception": false,
     "start_time": "2026-01-25T09:09:14.482629",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df=pd.read_csv('/kaggle/working/BSESN.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "ecbecb19",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:14.521090Z",
     "iopub.status.busy": "2026-01-25T09:09:14.520724Z",
     "iopub.status.idle": "2026-01-25T09:09:14.533363Z",
     "shell.execute_reply": "2026-01-25T09:09:14.532251Z"
    },
    "papermill": {
     "duration": 0.021024,
     "end_time": "2026-01-25T09:09:14.535534",
     "exception": false,
     "start_time": "2026-01-25T09:09:14.514510",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Date</th>\n",
       "      <th>BSESN_Open</th>\n",
       "      <th>BSESN_High</th>\n",
       "      <th>BSESN_Low</th>\n",
       "      <th>BSESN_Close</th>\n",
       "      <th>BSESN_Adj Close</th>\n",
       "      <th>BSESN_Volume</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2003-07-13</td>\n",
       "      <td>3704.629883</td>\n",
       "      <td>3726.560059</td>\n",
       "      <td>3704.629883</td>\n",
       "      <td>3720.750000</td>\n",
       "      <td>3720.750000</td>\n",
       "      <td>21200</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2003-07-14</td>\n",
       "      <td>3719.169922</td>\n",
       "      <td>3733.879883</td>\n",
       "      <td>3657.179932</td>\n",
       "      <td>3686.340088</td>\n",
       "      <td>3686.340088</td>\n",
       "      <td>22800</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2003-07-15</td>\n",
       "      <td>3702.139893</td>\n",
       "      <td>3729.020020</td>\n",
       "      <td>3662.699951</td>\n",
       "      <td>3721.649902</td>\n",
       "      <td>3721.649902</td>\n",
       "      <td>18400</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2003-07-16</td>\n",
       "      <td>3728.840088</td>\n",
       "      <td>3750.000000</td>\n",
       "      <td>3660.340088</td>\n",
       "      <td>3668.909912</td>\n",
       "      <td>3668.909912</td>\n",
       "      <td>22000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2003-07-17</td>\n",
       "      <td>3651.389893</td>\n",
       "      <td>3684.229980</td>\n",
       "      <td>3625.729980</td>\n",
       "      <td>3647.580078</td>\n",
       "      <td>3647.580078</td>\n",
       "      <td>22000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         Date   BSESN_Open   BSESN_High    BSESN_Low  BSESN_Close  \\\n",
       "0  2003-07-13  3704.629883  3726.560059  3704.629883  3720.750000   \n",
       "1  2003-07-14  3719.169922  3733.879883  3657.179932  3686.340088   \n",
       "2  2003-07-15  3702.139893  3729.020020  3662.699951  3721.649902   \n",
       "3  2003-07-16  3728.840088  3750.000000  3660.340088  3668.909912   \n",
       "4  2003-07-17  3651.389893  3684.229980  3625.729980  3647.580078   \n",
       "\n",
       "   BSESN_Adj Close  BSESN_Volume  \n",
       "0      3720.750000         21200  \n",
       "1      3686.340088         22800  \n",
       "2      3721.649902         18400  \n",
       "3      3668.909912         22000  \n",
       "4      3647.580078         22000  "
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head(5)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6c439739",
   "metadata": {
    "papermill": {
     "duration": 0.005119,
     "end_time": "2026-01-25T09:09:14.545861",
     "exception": false,
     "start_time": "2026-01-25T09:09:14.540742",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Merging all files"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "61ae2a44",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:14.557924Z",
     "iopub.status.busy": "2026-01-25T09:09:14.557294Z",
     "iopub.status.idle": "2026-01-25T09:09:14.695128Z",
     "shell.execute_reply": "2026-01-25T09:09:14.693787Z"
    },
    "papermill": {
     "duration": 0.146747,
     "end_time": "2026-01-25T09:09:14.697620",
     "exception": false,
     "start_time": "2026-01-25T09:09:14.550873",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "rm: cannot remove '/kaggle/working/Merged_data.csv': No such file or directory\r\n"
     ]
    }
   ],
   "source": [
    "!rm /kaggle/working/Merged_data.csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "ce030956",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:14.710017Z",
     "iopub.status.busy": "2026-01-25T09:09:14.709523Z",
     "iopub.status.idle": "2026-01-25T09:09:14.715464Z",
     "shell.execute_reply": "2026-01-25T09:09:14.714124Z"
    },
    "papermill": {
     "duration": 0.014976,
     "end_time": "2026-01-25T09:09:14.717630",
     "exception": false,
     "start_time": "2026-01-25T09:09:14.702654",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "files = glob.glob('/kaggle/input/data-cleaning-historical/*.csv') "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "2f077205",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:14.730905Z",
     "iopub.status.busy": "2026-01-25T09:09:14.729534Z",
     "iopub.status.idle": "2026-01-25T09:09:14.735347Z",
     "shell.execute_reply": "2026-01-25T09:09:14.734243Z"
    },
    "papermill": {
     "duration": 0.014679,
     "end_time": "2026-01-25T09:09:14.737437",
     "exception": false,
     "start_time": "2026-01-25T09:09:14.722758",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "files.remove('/kaggle/input/data-cleaning-historical/Cleaned_RELIANCE.NS_Max.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "cc4ec594",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:14.749918Z",
     "iopub.status.busy": "2026-01-25T09:09:14.749133Z",
     "iopub.status.idle": "2026-01-25T09:09:14.755670Z",
     "shell.execute_reply": "2026-01-25T09:09:14.754376Z"
    },
    "papermill": {
     "duration": 0.015334,
     "end_time": "2026-01-25T09:09:14.757940",
     "exception": false,
     "start_time": "2026-01-25T09:09:14.742606",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['/kaggle/input/data-cleaning-historical/Cleaned_NSEI_MAX.csv', '/kaggle/input/data-cleaning-historical/Cleaned_IXIC_Max.csv', '/kaggle/input/data-cleaning-historical/Cleaned_HDFCBANK.NS_MAX_NSE.csv', '/kaggle/input/data-cleaning-historical/Cleaned_GSPC_Max.csv', '/kaggle/input/data-cleaning-historical/Cleaned_BSESN_Max.csv', '/kaggle/input/data-cleaning-historical/Cleaned_RUT_Max.csv']\n"
     ]
    }
   ],
   "source": [
    "print(files)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "bcb7615a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:14.769905Z",
     "iopub.status.busy": "2026-01-25T09:09:14.769515Z",
     "iopub.status.idle": "2026-01-25T09:09:15.637498Z",
     "shell.execute_reply": "2026-01-25T09:09:15.636329Z"
    },
    "papermill": {
     "duration": 0.876821,
     "end_time": "2026-01-25T09:09:15.639808",
     "exception": false,
     "start_time": "2026-01-25T09:09:14.762987",
     "status": "completed"
    },
    "scrolled": true,
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Found 6 files. Processing...\n",
      " Loaded Cleaned_NSEI_MAX | 4520 rows\n",
      " Loaded Cleaned_IXIC_Max | 10392 rows\n",
      " Loaded Cleaned_HDFCBANK | 7885 rows\n",
      " Loaded Cleaned_GSPC_Max | 19126 rows\n",
      " Loaded Cleaned_BSESN_Max | 5531 rows\n",
      " Loaded Cleaned_RUT_Max | 9654 rows\n",
      "\n",
      "Merge Complete!\n",
      "Final Shape: (20950, 35)\n",
      "Date Range: 1950-01-03 00:00:00 to 2026-01-09 00:00:00\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Date</th>\n",
       "      <th>Cleaned_NSEI_MAX_Close</th>\n",
       "      <th>Cleaned_NSEI_MAX_Open</th>\n",
       "      <th>Cleaned_NSEI_MAX_High</th>\n",
       "      <th>Cleaned_NSEI_MAX_Low</th>\n",
       "      <th>Cleaned_NSEI_MAX_Volume</th>\n",
       "      <th>Cleaned_IXIC_Max_Open</th>\n",
       "      <th>Cleaned_IXIC_Max_High</th>\n",
       "      <th>Cleaned_IXIC_Max_Low</th>\n",
       "      <th>Cleaned_IXIC_Max_Close</th>\n",
       "      <th>...</th>\n",
       "      <th>Cleaned_BSESN_Max_Low</th>\n",
       "      <th>Cleaned_BSESN_Max_Close</th>\n",
       "      <th>Cleaned_BSESN_Max_Adj Close</th>\n",
       "      <th>Cleaned_BSESN_Max_Volume</th>\n",
       "      <th>Cleaned_RUT_Max_Open</th>\n",
       "      <th>Cleaned_RUT_Max_High</th>\n",
       "      <th>Cleaned_RUT_Max_Low</th>\n",
       "      <th>Cleaned_RUT_Max_Close</th>\n",
       "      <th>Cleaned_RUT_Max_Adj Close</th>\n",
       "      <th>Cleaned_RUT_Max_Volume</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1950-01-03</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1950-01-04</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1950-01-05</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1950-01-06</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1950-01-09</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 35 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        Date  Cleaned_NSEI_MAX_Close  Cleaned_NSEI_MAX_Open  \\\n",
       "0 1950-01-03                     NaN                    NaN   \n",
       "1 1950-01-04                     NaN                    NaN   \n",
       "2 1950-01-05                     NaN                    NaN   \n",
       "3 1950-01-06                     NaN                    NaN   \n",
       "4 1950-01-09                     NaN                    NaN   \n",
       "\n",
       "   Cleaned_NSEI_MAX_High  Cleaned_NSEI_MAX_Low  Cleaned_NSEI_MAX_Volume  \\\n",
       "0                    NaN                   NaN                      NaN   \n",
       "1                    NaN                   NaN                      NaN   \n",
       "2                    NaN                   NaN                      NaN   \n",
       "3                    NaN                   NaN                      NaN   \n",
       "4                    NaN                   NaN                      NaN   \n",
       "\n",
       "   Cleaned_IXIC_Max_Open  Cleaned_IXIC_Max_High  Cleaned_IXIC_Max_Low  \\\n",
       "0                    NaN                    NaN                   NaN   \n",
       "1                    NaN                    NaN                   NaN   \n",
       "2                    NaN                    NaN                   NaN   \n",
       "3                    NaN                    NaN                   NaN   \n",
       "4                    NaN                    NaN                   NaN   \n",
       "\n",
       "   Cleaned_IXIC_Max_Close  ...  Cleaned_BSESN_Max_Low  \\\n",
       "0                     NaN  ...                    NaN   \n",
       "1                     NaN  ...                    NaN   \n",
       "2                     NaN  ...                    NaN   \n",
       "3                     NaN  ...                    NaN   \n",
       "4                     NaN  ...                    NaN   \n",
       "\n",
       "   Cleaned_BSESN_Max_Close  Cleaned_BSESN_Max_Adj Close  \\\n",
       "0                      NaN                          NaN   \n",
       "1                      NaN                          NaN   \n",
       "2                      NaN                          NaN   \n",
       "3                      NaN                          NaN   \n",
       "4                      NaN                          NaN   \n",
       "\n",
       "   Cleaned_BSESN_Max_Volume  Cleaned_RUT_Max_Open  Cleaned_RUT_Max_High  \\\n",
       "0                       NaN                   NaN                   NaN   \n",
       "1                       NaN                   NaN                   NaN   \n",
       "2                       NaN                   NaN                   NaN   \n",
       "3                       NaN                   NaN                   NaN   \n",
       "4                       NaN                   NaN                   NaN   \n",
       "\n",
       "   Cleaned_RUT_Max_Low  Cleaned_RUT_Max_Close  Cleaned_RUT_Max_Adj Close  \\\n",
       "0                  NaN                    NaN                        NaN   \n",
       "1                  NaN                    NaN                        NaN   \n",
       "2                  NaN                    NaN                        NaN   \n",
       "3                  NaN                    NaN                        NaN   \n",
       "4                  NaN                    NaN                        NaN   \n",
       "\n",
       "   Cleaned_RUT_Max_Volume  \n",
       "0                     NaN  \n",
       "1                     NaN  \n",
       "2                     NaN  \n",
       "3                     NaN  \n",
       "4                     NaN  \n",
       "\n",
       "[5 rows x 35 columns]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "target_cols = ['Open', 'High', 'Low', 'Close', 'Adj Close', 'Volume']\n",
    "\n",
    "all_dataframes = []\n",
    "\n",
    "print(f\"Found {len(files)} files. Processing...\")\n",
    "\n",
    "for file in files:\n",
    "    stock_name = os.path.basename(file).split('.')[0]\n",
    "    df = pd.read_csv(file)\n",
    "    date_col = None\n",
    "    for col in df.columns:\n",
    "        if col.lower() in ['date', 'datetime', 'timestamp']:\n",
    "            date_col = col\n",
    "            break        \n",
    "    if date_col:\n",
    "        df = df.rename(columns={date_col: 'Date'})\n",
    "        df['Date'] = pd.to_datetime(df['Date'], errors='coerce')\n",
    "    else:\n",
    "        print(f\"⚠️ SKIPPING {stock_name}: No Date column found.\")\n",
    "        continue\n",
    "    new_names = {}\n",
    "    for col in df.columns:\n",
    "        if col == 'Date': continue\n",
    "        for target in target_cols:\n",
    "            if col.lower() == target.lower():\n",
    "                new_names[col] = target\n",
    "                break\n",
    "    \n",
    "    df = df.rename(columns=new_names)\n",
    "    df = df.set_index('Date')\n",
    "    valid_cols = [c for c in df.columns if c in target_cols]\n",
    "    df = df[valid_cols]\n",
    "    df = df.add_prefix(f\"{stock_name}_\")\n",
    "    df = df.reset_index()\n",
    "    all_dataframes.append(df)\n",
    "    print(f\" Loaded {stock_name} | {len(df)} rows\")\n",
    "if all_dataframes:\n",
    "    df_final = reduce(lambda left, right: pd.merge(left, right, on='Date', how='outer'), all_dataframes)\n",
    "    df_final = df_final.sort_values('Date').reset_index(drop=True)\n",
    "    print(\"\\nMerge Complete!\")\n",
    "    print(f\"Final Shape: {df_final.shape}\")\n",
    "    print(f\"Date Range: {df_final['Date'].min()} to {df_final['Date'].max()}\")\n",
    "    display(df_final.head())\n",
    "\n",
    "    df_final.to_csv('Merged_data.csv', index=False)\n",
    "else:\n",
    "    print(\" No valid files found to merge.\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "9af54705",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:15.654662Z",
     "iopub.status.busy": "2026-01-25T09:09:15.653715Z",
     "iopub.status.idle": "2026-01-25T09:09:15.670572Z",
     "shell.execute_reply": "2026-01-25T09:09:15.669643Z"
    },
    "papermill": {
     "duration": 0.026102,
     "end_time": "2026-01-25T09:09:15.672638",
     "exception": false,
     "start_time": "2026-01-25T09:09:15.646536",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df_final['Date']=pd.to_datetime(df_final['Date'])\n",
    "df_final=df_final.set_index('Date',inplace=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "791373ba",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:15.686571Z",
     "iopub.status.busy": "2026-01-25T09:09:15.685829Z",
     "iopub.status.idle": "2026-01-25T09:09:15.707117Z",
     "shell.execute_reply": "2026-01-25T09:09:15.706117Z"
    },
    "papermill": {
     "duration": 0.031119,
     "end_time": "2026-01-25T09:09:15.709564",
     "exception": false,
     "start_time": "2026-01-25T09:09:15.678445",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Cleaned_NSEI_MAX_Close</th>\n",
       "      <th>Cleaned_NSEI_MAX_Open</th>\n",
       "      <th>Cleaned_NSEI_MAX_High</th>\n",
       "      <th>Cleaned_NSEI_MAX_Low</th>\n",
       "      <th>Cleaned_NSEI_MAX_Volume</th>\n",
       "      <th>Cleaned_IXIC_Max_Open</th>\n",
       "      <th>Cleaned_IXIC_Max_High</th>\n",
       "      <th>Cleaned_IXIC_Max_Low</th>\n",
       "      <th>Cleaned_IXIC_Max_Close</th>\n",
       "      <th>Cleaned_IXIC_Max_Adj Close</th>\n",
       "      <th>...</th>\n",
       "      <th>Cleaned_BSESN_Max_Low</th>\n",
       "      <th>Cleaned_BSESN_Max_Close</th>\n",
       "      <th>Cleaned_BSESN_Max_Adj Close</th>\n",
       "      <th>Cleaned_BSESN_Max_Volume</th>\n",
       "      <th>Cleaned_RUT_Max_Open</th>\n",
       "      <th>Cleaned_RUT_Max_High</th>\n",
       "      <th>Cleaned_RUT_Max_Low</th>\n",
       "      <th>Cleaned_RUT_Max_Close</th>\n",
       "      <th>Cleaned_RUT_Max_Adj Close</th>\n",
       "      <th>Cleaned_RUT_Max_Volume</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Date</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1950-01-03</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1950-01-04</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1950-01-05</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1950-01-06</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1950-01-09</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 34 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            Cleaned_NSEI_MAX_Close  Cleaned_NSEI_MAX_Open  \\\n",
       "Date                                                        \n",
       "1950-01-03                     NaN                    NaN   \n",
       "1950-01-04                     NaN                    NaN   \n",
       "1950-01-05                     NaN                    NaN   \n",
       "1950-01-06                     NaN                    NaN   \n",
       "1950-01-09                     NaN                    NaN   \n",
       "\n",
       "            Cleaned_NSEI_MAX_High  Cleaned_NSEI_MAX_Low  \\\n",
       "Date                                                      \n",
       "1950-01-03                    NaN                   NaN   \n",
       "1950-01-04                    NaN                   NaN   \n",
       "1950-01-05                    NaN                   NaN   \n",
       "1950-01-06                    NaN                   NaN   \n",
       "1950-01-09                    NaN                   NaN   \n",
       "\n",
       "            Cleaned_NSEI_MAX_Volume  Cleaned_IXIC_Max_Open  \\\n",
       "Date                                                         \n",
       "1950-01-03                      NaN                    NaN   \n",
       "1950-01-04                      NaN                    NaN   \n",
       "1950-01-05                      NaN                    NaN   \n",
       "1950-01-06                      NaN                    NaN   \n",
       "1950-01-09                      NaN                    NaN   \n",
       "\n",
       "            Cleaned_IXIC_Max_High  Cleaned_IXIC_Max_Low  \\\n",
       "Date                                                      \n",
       "1950-01-03                    NaN                   NaN   \n",
       "1950-01-04                    NaN                   NaN   \n",
       "1950-01-05                    NaN                   NaN   \n",
       "1950-01-06                    NaN                   NaN   \n",
       "1950-01-09                    NaN                   NaN   \n",
       "\n",
       "            Cleaned_IXIC_Max_Close  Cleaned_IXIC_Max_Adj Close  ...  \\\n",
       "Date                                                            ...   \n",
       "1950-01-03                     NaN                         NaN  ...   \n",
       "1950-01-04                     NaN                         NaN  ...   \n",
       "1950-01-05                     NaN                         NaN  ...   \n",
       "1950-01-06                     NaN                         NaN  ...   \n",
       "1950-01-09                     NaN                         NaN  ...   \n",
       "\n",
       "            Cleaned_BSESN_Max_Low  Cleaned_BSESN_Max_Close  \\\n",
       "Date                                                         \n",
       "1950-01-03                    NaN                      NaN   \n",
       "1950-01-04                    NaN                      NaN   \n",
       "1950-01-05                    NaN                      NaN   \n",
       "1950-01-06                    NaN                      NaN   \n",
       "1950-01-09                    NaN                      NaN   \n",
       "\n",
       "            Cleaned_BSESN_Max_Adj Close  Cleaned_BSESN_Max_Volume  \\\n",
       "Date                                                                \n",
       "1950-01-03                          NaN                       NaN   \n",
       "1950-01-04                          NaN                       NaN   \n",
       "1950-01-05                          NaN                       NaN   \n",
       "1950-01-06                          NaN                       NaN   \n",
       "1950-01-09                          NaN                       NaN   \n",
       "\n",
       "            Cleaned_RUT_Max_Open  Cleaned_RUT_Max_High  Cleaned_RUT_Max_Low  \\\n",
       "Date                                                                          \n",
       "1950-01-03                   NaN                   NaN                  NaN   \n",
       "1950-01-04                   NaN                   NaN                  NaN   \n",
       "1950-01-05                   NaN                   NaN                  NaN   \n",
       "1950-01-06                   NaN                   NaN                  NaN   \n",
       "1950-01-09                   NaN                   NaN                  NaN   \n",
       "\n",
       "            Cleaned_RUT_Max_Close  Cleaned_RUT_Max_Adj Close  \\\n",
       "Date                                                           \n",
       "1950-01-03                    NaN                        NaN   \n",
       "1950-01-04                    NaN                        NaN   \n",
       "1950-01-05                    NaN                        NaN   \n",
       "1950-01-06                    NaN                        NaN   \n",
       "1950-01-09                    NaN                        NaN   \n",
       "\n",
       "            Cleaned_RUT_Max_Volume  \n",
       "Date                                \n",
       "1950-01-03                     NaN  \n",
       "1950-01-04                     NaN  \n",
       "1950-01-05                     NaN  \n",
       "1950-01-06                     NaN  \n",
       "1950-01-09                     NaN  \n",
       "\n",
       "[5 rows x 34 columns]"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_final.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "2a6bd5e2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:15.724379Z",
     "iopub.status.busy": "2026-01-25T09:09:15.723030Z",
     "iopub.status.idle": "2026-01-25T09:09:15.730587Z",
     "shell.execute_reply": "2026-01-25T09:09:15.729581Z"
    },
    "papermill": {
     "duration": 0.017012,
     "end_time": "2026-01-25T09:09:15.732624",
     "exception": false,
     "start_time": "2026-01-25T09:09:15.715612",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Cleaned_NSEI_MAX_Close', 'Cleaned_NSEI_MAX_Open',\n",
       "       'Cleaned_NSEI_MAX_High', 'Cleaned_NSEI_MAX_Low',\n",
       "       'Cleaned_NSEI_MAX_Volume', 'Cleaned_IXIC_Max_Open',\n",
       "       'Cleaned_IXIC_Max_High', 'Cleaned_IXIC_Max_Low',\n",
       "       'Cleaned_IXIC_Max_Close', 'Cleaned_IXIC_Max_Adj Close',\n",
       "       'Cleaned_IXIC_Max_Volume', 'Cleaned_HDFCBANK_Close',\n",
       "       'Cleaned_HDFCBANK_Open', 'Cleaned_HDFCBANK_High',\n",
       "       'Cleaned_HDFCBANK_Low', 'Cleaned_HDFCBANK_Volume',\n",
       "       'Cleaned_GSPC_Max_Open', 'Cleaned_GSPC_Max_High',\n",
       "       'Cleaned_GSPC_Max_Low', 'Cleaned_GSPC_Max_Close',\n",
       "       'Cleaned_GSPC_Max_Adj Close', 'Cleaned_GSPC_Max_Volume',\n",
       "       'Cleaned_BSESN_Max_Open', 'Cleaned_BSESN_Max_High',\n",
       "       'Cleaned_BSESN_Max_Low', 'Cleaned_BSESN_Max_Close',\n",
       "       'Cleaned_BSESN_Max_Adj Close', 'Cleaned_BSESN_Max_Volume',\n",
       "       'Cleaned_RUT_Max_Open', 'Cleaned_RUT_Max_High', 'Cleaned_RUT_Max_Low',\n",
       "       'Cleaned_RUT_Max_Close', 'Cleaned_RUT_Max_Adj Close',\n",
       "       'Cleaned_RUT_Max_Volume'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_final.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "67d7b84e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2026-01-25T09:09:15.747329Z",
     "iopub.status.busy": "2026-01-25T09:09:15.746818Z",
     "iopub.status.idle": "2026-01-25T09:09:17.836379Z",
     "shell.execute_reply": "2026-01-25T09:09:17.835254Z"
    },
    "papermill": {
     "duration": 2.099504,
     "end_time": "2026-01-25T09:09:17.838332",
     "exception": false,
     "start_time": "2026-01-25T09:09:15.738828",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Copying files:\n",
      "  ✓ Merged_data.csv\n",
      "  ✓ NSEI.csv\n",
      "  ✓ IXIC.csv\n",
      "  ✓ RUT.csv\n",
      "  ✓ GSPC.csv\n",
      "  ✓ BSESN.csv\n",
      "  ✓ HDFCBANK.NS.csv\n",
      "\n",
      "Copying folders:\n",
      "\n",
      "✅ Success! https://github.com/Zalanemoj/General/tree/main/Outputs_Data-Cleaning-Index\n"
     ]
    }
   ],
   "source": [
    "import os\n",
    "import glob\n",
    "import subprocess\n",
    "import shutil\n",
    "from datetime import datetime\n",
    "from kaggle_secrets import UserSecretsClient\n",
    "\n",
    "GITHUB_USERNAME = \"Zalanemoj\"\n",
    "GITHUB_REPO = \"General\"\n",
    "GITHUB_EMAIL = \"zalanemoj777@gmail.com\"\n",
    "GITHUB_DIR = \"Outputs_Data-Cleaning-Index\"\n",
    "BRANCH = \"main\"\n",
    "\n",
    "FILES_TO_PUSH = [\"*.csv\", \"*.png\", \"*.jpg\", \"*.json\",\"*.pkl\"]\n",
    "FOLDERS_TO_PUSH = [\"*\"]\n",
    "\n",
    "TOKEN = UserSecretsClient().get_secret(\"GITHUB_TOKEN\")\n",
    "REPO_URL = f\"https://{TOKEN}@github.com/{GITHUB_USERNAME}/{GITHUB_REPO}.git\"\n",
    "\n",
    "source = \"/kaggle/working\"\n",
    "temp = \"/kaggle/working/git_temp\"\n",
    "\n",
    "if os.path.exists(temp):\n",
    "    shutil.rmtree(temp)\n",
    "os.makedirs(temp)\n",
    "\n",
    "os.chdir(temp)\n",
    "subprocess.run([\"git\", \"init\"], capture_output=True)\n",
    "subprocess.run([\"git\", \"config\", \"user.email\", GITHUB_EMAIL], capture_output=True)\n",
    "subprocess.run([\"git\", \"config\", \"user.name\", GITHUB_USERNAME], capture_output=True)\n",
    "subprocess.run([\"git\", \"remote\", \"add\", \"origin\", REPO_URL], capture_output=True)\n",
    "subprocess.run([\"git\", \"pull\", \"origin\", BRANCH], capture_output=True)\n",
    "\n",
    "target = os.path.join(temp, GITHUB_DIR)\n",
    "os.makedirs(target, exist_ok=True)\n",
    "IGNORE_FOLDERS = [\"git_temp\", \".virtual_documents\", \".git\"]\n",
    "os.chdir(source)\n",
    "\n",
    "print(\"Copying files:\")\n",
    "for pattern in FILES_TO_PUSH:\n",
    "    for item in glob.glob(pattern):\n",
    "        shutil.copy2(item, target)\n",
    "        print(f\"  ✓ {item}\")\n",
    "\n",
    "print(\"\\nCopying folders:\")\n",
    "for pattern in FOLDERS_TO_PUSH:\n",
    "    for folder in glob.glob(pattern):\n",
    "        if any(ignored in folder for ignored in IGNORE_FOLDERS):\n",
    "            continue\n",
    "\n",
    "        if os.path.isdir(folder):\n",
    "            dest = os.path.join(target, folder)\n",
    "            if os.path.exists(dest):\n",
    "                shutil.rmtree(dest)\n",
    "            shutil.copytree(folder, dest)\n",
    "            print(f\"  ✓ {folder}/\")\n",
    "\n",
    "os.chdir(temp)\n",
    "subprocess.run([\"git\", \"add\", \"-A\"], capture_output=True)\n",
    "subprocess.run([\"git\", \"commit\", \"-m\", f\"Update {datetime.now().strftime('%Y-%m-%d %H:%M')}\"], capture_output=True)\n",
    "subprocess.run([\"git\", \"branch\", \"-M\", BRANCH], capture_output=True)\n",
    "\n",
    "result = subprocess.run([\"git\", \"push\", \"-f\", \"origin\", BRANCH], capture_output=True, text=True)\n",
    "\n",
    "if result.returncode == 0:\n",
    "    print(f\"\\n✅ Success! https://github.com/{GITHUB_USERNAME}/{GITHUB_REPO}/tree/{BRANCH}/{GITHUB_DIR}\")\n",
    "else:\n",
    "    print(f\"\\n❌ Failed: {result.stderr}\")\n",
    "\n",
    "os.chdir(source)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0ee0f2f6",
   "metadata": {
    "papermill": {
     "duration": 0.00594,
     "end_time": "2026-01-25T09:09:17.850836",
     "exception": false,
     "start_time": "2026-01-25T09:09:17.844896",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "sourceId": 291300003,
     "sourceType": "kernelVersion"
    }
   ],
   "dockerImageVersionId": 31259,
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.12"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 10.644616,
   "end_time": "2026-01-25T09:09:18.480412",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2026-01-25T09:09:07.835796",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
